import React, { useState, useContext } from 'react';
import { useLocation } from 'react-router-dom';
import Sticky from 'react-stickynode';
import { IoIosClose } from 'react-icons/io';
import { Button, Drawer } from 'antd';
import Logo from 'components/UI/Logo/Logo';
import Text from 'components/UI/Text/Text';
import TextLink from 'components/UI/TextLink/TextLink';
import Navbar from 'components/Navbar/Navbar';
import { AuthContext } from 'context/AuthProvider';
import { LayoutContext } from 'context/LayoutProvider';
import useWindowSize from 'library/hooks/useWindowSize';
import { AGENT_PROFILE_PAGE } from 'settings/constant';
import AuthMenu from './AuthMenu';
import MainMenu from './MainMenu';
import MobileMenu from './MobileMenu';
import ProfileMenu from './ProfileMenu';
import NavbarSearch from './NavbarSearch';
import HeaderWrapper, {
  MobileNavbar,
  CloseDrawer,
  AvatarWrapper,
  AvatarImage,
  AvatarInfo,
  LogoArea,
} from './Header.style';

const avatarImg = `http://s3.amazonaws.com/redqteam.com/isomorphic-reloaded-image/profilepic.png`;
const LogoIcon = () => (
  <svg height="130" viewBox="0 0 448 84" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M92.0801 12.5053C92.3182 13.0477 91.7231 13.1866 91.161 12.9948C84.0195 10.5409 79.6024 11.3611 77.288 11.7645C67.1114 13.5173 61.0676 20.482 52.7292 28.0883C48.8675 31.607 41.9971 39.6895 32.0916 42.6328C23.912 45.0668 14.9322 41.9515 7.79073 37.8838C5.99875 36.8653 4.29273 35.6615 2.80492 34.2262C2.03787 33.4854 1.29066 32.8042 0.616181 31.9774C0.384744 31.6996 -0.02523 31.1506 0.00121996 30.7604C0.0276699 30.3172 0.510382 30.0196 0.926968 30.1651C3.34714 31.0316 5.64829 32.1163 8.19409 32.6454C11.0176 33.2341 13.9403 33.3465 16.8036 32.9629C24.9039 31.8716 31.146 26.6001 36.9055 21.2029C41.1772 17.2014 45.224 12.9485 49.7536 9.23133C54.0186 5.73906 58.8127 2.68332 64.2614 1.49938C71.8195 -0.140927 79.9131 2.21371 86.109 6.67165C87.2662 7.50503 88.3573 8.4244 89.3955 9.39668C90.3609 10.2962 91.5379 11.2619 92.0735 12.5053H92.0801Z" fill="#054D92"/>
<path d="M109.99 32.2749C110.228 32.8172 109.633 32.9561 109.071 32.7643C101.93 30.3105 97.5125 31.1306 95.1981 31.5341C85.0215 33.2868 78.9777 40.2515 70.6394 47.8578C66.7777 51.3765 59.9073 59.459 50.0018 62.4023C41.8221 64.8363 32.8424 61.7211 25.7009 57.6534C23.9089 56.6348 22.2029 55.431 20.7151 53.9957C19.948 53.255 19.2008 52.5737 18.5263 51.7469C18.2949 51.4691 17.8849 50.9202 17.9114 50.5299C17.9378 50.0868 18.4205 49.7891 18.8371 49.9347C21.2573 50.8011 23.5584 51.8858 26.1042 52.415C28.9278 53.0036 31.8505 53.1161 34.7137 52.7324C42.814 51.6411 49.0562 46.3696 54.8157 40.9725C59.0873 36.9709 63.1342 32.718 67.6637 29.0009C71.9288 25.5086 76.7229 22.4528 82.1715 21.2689C89.7296 19.6286 97.8233 21.9832 104.019 26.4412C105.176 27.2746 106.267 28.1939 107.306 29.1662C108.271 30.0657 109.448 31.0314 109.984 32.2749H109.99Z" fill="#179BE7"/>
<path d="M127.897 52.0385C128.135 52.5809 127.539 52.7198 126.977 52.528C119.836 50.0741 115.419 50.8943 113.104 51.2978C102.928 53.0505 96.884 60.0152 88.5456 67.6215C84.6839 71.1402 77.8135 79.2227 67.908 82.166C59.7284 84.6 50.7486 81.4847 43.6071 77.417C41.8152 76.3985 40.1091 75.1947 38.6213 73.7594C37.8543 73.0186 37.1071 72.3374 36.4326 71.5106C36.2012 71.2328 35.7912 70.6838 35.8176 70.2936C35.8441 69.8505 36.3268 69.5528 36.7434 69.6983C39.1635 70.5648 41.4647 71.6495 44.0105 72.1786C46.834 72.7673 49.7568 72.8797 52.62 72.4961C60.7203 71.4048 66.9624 66.1333 72.7219 60.7361C76.9936 56.7346 81.0404 52.4817 85.57 48.7645C89.835 45.2723 94.6291 42.2165 100.078 41.0326C107.636 39.3923 115.73 41.7469 121.925 46.2049C123.083 47.0382 124.174 47.9576 125.212 48.9299C126.177 49.8294 127.354 50.7951 127.89 52.0385H127.897Z" fill="#38B2E9"/>
<g clip-path="url(#clip0_2849_988)">
<path d="M147.711 75.6758H145.394L172.39 8.18609H174.807L201.803 75.6758H199.487L189.615 50.896H157.582L147.711 75.6758ZM169.67 20.576L158.288 49.0828H188.91L177.527 20.576L173.599 10.4022L169.67 20.576ZM212.241 76.6831C205.995 76.6831 199.952 73.359 199.952 63.7895V29.7425H191.994V27.9293H199.952V19.5687L201.966 18.0577V27.9293H218.788V29.7425H201.966V63.8903C201.966 72.0495 206.902 74.8699 212.241 74.8699C216.471 74.8699 221.206 72.7546 223.321 68.6246L224.429 70.4378C222.213 74.2655 217.177 76.6831 212.241 76.6831ZM224.964 75.6758H222.949V8.18609H224.964V75.6758ZM237.926 76.6831C230.674 76.6831 226.443 73.1575 226.443 66.9122C226.443 60.8683 230.774 57.1413 237.02 54.2201L256.763 44.9529V41.6287C256.763 32.16 251.424 28.9367 244.172 28.9367C236.415 28.9367 229.969 33.2681 227.148 38.6068L225.637 37.0959C228.558 31.9586 235.307 26.922 244.172 26.922C254.345 26.922 258.778 32.4622 258.778 41.4273V69.6319C258.778 72.8553 260.389 73.8626 263.411 73.8626H265.627V75.6758H263.512C259.08 75.6758 256.763 74.0641 256.763 69.6319V61.1705C255.252 69.4305 246.69 76.6831 237.926 76.6831ZM228.458 66.8115C228.458 72.3517 232.688 74.8699 237.926 74.8699C248.705 74.8699 256.763 64.6961 256.763 59.1559V46.8667L238.128 55.7311C231.48 58.8537 228.458 61.9764 228.458 66.8115ZM282.647 76.6831C273.48 76.6831 264.314 72.2509 262.199 62.1778L264.012 60.7676C265.22 69.5312 272.675 74.8699 282.647 74.8699C290.806 74.8699 295.843 71.2436 295.843 64.5954C295.843 58.4508 291.713 55.7311 283.453 53.7164L276.704 52.1048C269.653 50.3923 263.307 47.3704 263.307 39.4127C263.307 32.0593 269.35 26.922 278.215 26.922C288.59 26.922 294.332 31.6564 296.346 39.5134L294.735 40.6214C292.619 32.2608 286.978 28.7352 278.215 28.7352C270.761 28.7352 265.321 32.6637 265.321 39.4127C265.321 46.0609 270.056 48.3777 277.711 50.2916L284.662 52.004C292.72 54.0186 297.857 57.4435 297.857 64.4947C297.857 72.956 290.705 76.6831 282.647 76.6831ZM327.583 76.6831C309.25 76.6831 296.86 61.4727 296.86 41.8302C296.86 22.3891 309.25 7.17878 327.583 7.17878C345.916 7.17878 358.306 22.3891 358.306 41.8302C358.306 61.4727 345.916 76.6831 327.583 76.6831ZM327.583 74.8699C344.808 74.8699 356.291 60.3647 356.291 41.8302C356.291 23.4972 344.808 8.99193 327.583 8.99193C310.358 8.99193 298.875 23.4972 298.875 41.8302C298.875 60.3647 310.358 74.8699 327.583 74.8699ZM363.118 75.6758H361.104V27.9293H363.118V42.6361C364.327 34.2754 370.472 26.922 378.933 26.922C385.38 26.922 389.308 30.6491 389.308 36.5922C389.308 39.2112 388.805 42.2331 387.596 44.7514H385.38C386.387 42.9382 387.294 39.8156 387.294 36.5922C387.294 32.6637 384.775 28.7352 378.53 28.7352C369.263 28.7352 363.118 38.5061 363.118 47.0682V75.6758ZM396.05 76.6831C388.798 76.6831 384.567 73.1575 384.567 66.9122C384.567 60.8683 388.898 57.1413 395.144 54.2201L414.887 44.9529V41.6287C414.887 32.16 409.548 28.9367 402.296 28.9367C394.539 28.9367 388.092 33.2681 385.272 38.6068L383.761 37.0959C386.682 31.9586 393.431 26.922 402.296 26.922C412.469 26.922 416.902 32.4622 416.902 41.4273V69.6319C416.902 72.8553 418.513 73.8626 421.535 73.8626H423.751V75.6758H421.636C417.204 75.6758 414.887 74.0641 414.887 69.6319V61.1705C413.376 69.4305 404.814 76.6831 396.05 76.6831ZM386.582 66.8115C386.582 72.3517 390.812 74.8699 396.05 74.8699C406.828 74.8699 414.887 64.6961 414.887 59.1559V46.8667L396.252 55.7311C389.603 58.8537 386.582 61.9764 386.582 66.8115Z" fill="#189CE6"/>
</g>
  <defs>
    <clipPath id="clip0_2849_988">
      <rect width="319.98" height="82.0462" fill="white" transform="translate(127.949 0.976562)"/>
    </clipPath>
  </defs>
</svg>

);

export default function Header() {
  let location = useLocation();
  const [{ searchVisibility }] = useContext(LayoutContext);
  const { loggedIn } = useContext(AuthContext);
  const { width } = useWindowSize();
  const [state, setState] = useState(false);
  const sidebarHandler = () => {
    setState(!state);
  };
  const headerType = location.pathname === '/' ? 'transparent' : 'default';

  return (
    <HeaderWrapper>
      <Sticky
        top={headerType === 'transparent' ? -1 : 0}
        innerZ={10001}
        activeClass="isHeaderSticky"
      >
        {width > 991 ? (
          <Navbar
            logo={
              <>
                {headerType === 'transparent' && <LogoIcon />}
                <Logo
                  withLink
                  linkTo="/"
                  src="/images/logo-ao.svg"
                  title="Atlasora."
                />
              </>
            }
            navMenu={<MainMenu />}
            authMenu={<AuthMenu />}
            isLogin={loggedIn}
            avatar={<Logo src={avatarImg} />}
            profileMenu={<ProfileMenu avatar={<Logo src={avatarImg} />} />}
            headerType={headerType}
            searchComponent={<NavbarSearch />}
            location={location}
            searchVisibility={searchVisibility}
          />
        ) : (
          <MobileNavbar className={headerType}>
            <LogoArea>
              <>
                {headerType === 'transparent' && <LogoIcon />}
                <Logo
                  withLink
                  linkTo="/"
                  src="/images/logo-ao.svg"
                  title="Atlasora."
                />
              </>
              <NavbarSearch />
            </LogoArea>
            <Button
              className={`hamburg-btn ${state ? 'active' : ''}`}
              onClick={sidebarHandler}
            >
              <span />
              <span />
              <span />
            </Button>
            <Drawer
              placement="right"
              closable={false}
              onClose={sidebarHandler}
              width="285px"
              className="mobile-header"
              open={state}
            >
              <CloseDrawer>
                <button onClick={sidebarHandler}>
                  <IoIosClose />
                </button>
              </CloseDrawer>
              {loggedIn ? (
                <AvatarWrapper>
                  <AvatarImage>
                    <Logo src={avatarImg} />
                  </AvatarImage>
                  <AvatarInfo>
                    <Text as="h3" content="Nova Scotia" />
                    <TextLink
                      link={AGENT_PROFILE_PAGE}
                      content="View Profile"
                    />
                  </AvatarInfo>
                </AvatarWrapper>
              ) : (
                <AuthMenu className="auth-menu" />
              )}
              <MobileMenu className="main-menu" />
            </Drawer>
          </MobileNavbar>
        )}
      </Sticky>
    </HeaderWrapper>
  );
}
